# 実装すべき画面のTODOリスト

## 🚨 重要度：高 - 機能が動作しない/セキュリティリスクがある

### API/バックエンド
- [ ] `/api/questions` エンドポイントの実装
  - [ ] 質問一覧の取得（検索、フィルタリング、ページネーション対応）
  - [ ] 検索ページ（`/search/page.tsx`）で使用されているが未実装
  
- [ ] メール送信機能の実装
  - [ ] `src/app/api/auth/request-password-reset/route.ts` - パスワードリセットメール
  - [ ] `src/app/api/projects/[projectId]/invitations/route.ts` - 招待メール
  - [ ] SendGridやAWS SESなどのメールサービスの統合
  
- [ ] PasswordResetTokenモデルの追加
  - [ ] Prismaスキーマにモデル定義を追加
  - [ ] マイグレーションの実行
  - [ ] パスワードリセットトークンの有効期限管理
  
### セキュリティ
- [ ] CORS設定の実装
  - [ ] Next.jsのミドルウェアでCORSヘッダーを設定
  - [ ] 許可するオリジンの設定
  
- [ ] XSS対策の強化
  - [ ] ユーザー入力のサニタイズ処理
  - [ ] Content Security Policy (CSP) ヘッダーの設定
  
- [ ] CSRF対策の実装
  - [ ] CSRFトークンの生成と検証
  
- [ ] レート制限の実装
  - [ ] APIエンドポイントへのリクエスト制限
  - [ ] ブルートフォース攻撃対策

## 🔧 重要度：中 - 機能は動作するが改善が必要

### UI/UX
- [ ] フォームビルダーUIの実装
  - [ ] `src/app/components/questions/QuestionForm.tsx` - 370行目のTODOコメント
  - [ ] ドラッグ&ドロップでフィールドを追加/並び替え
  - [ ] フィールドタイプの選択UI
  - [ ] プレビュー機能
  
- [ ] ファイルアップロード機能の改善
  - [ ] プログレスバーの実装
  - [ ] ファイルサイズ制限の明確な表示
  - [ ] 複数ファイルの一括アップロード
  - [ ] アップロード済みファイルのプレビュー機能
  
- [ ] エラーハンドリングの統一
  - [ ] グローバルエラーハンドラーの実装
  - [ ] エラーメッセージの国際化対応
  - [ ] ユーザーフレンドリーなエラー表示

### API/バックエンド
- [ ] 添付ファイル関連APIの完全実装
  - [ ] `/api/attachments/[fileId]` - ファイルダウンロード
  - [ ] `/api/attachments/[fileId]/metadata` - ファイルメタデータ取得
  - [ ] ファイル削除エンドポイント
  
- [ ] ログ機能の実装
  - [ ] 構造化ログライブラリ（Winston、Pino等）の導入
  - [ ] アクセスログ
  - [ ] エラーログ
  - [ ] 監査ログ（重要な操作の記録）
  
- [ ] バックアップ機能
  - [ ] データベースの定期バックアップ
  - [ ] アップロードファイルのバックアップ

### パフォーマンス
- [ ] キャッシュ戦略の実装
  - [ ] Redisの導入検討
  - [ ] APIレスポンスのキャッシュ
  - [ ] 静的アセットのキャッシュ設定
  
- [ ] データベースクエリの最適化
  - [ ] N+1問題の解決
  - [ ] インデックスの最適化
  - [ ] 大量データ処理の改善

## 📝 重要度：低 - 改善により開発効率/保守性が向上

### ドキュメント
- [ ] 環境変数の設定ドキュメント
  - [ ] 必要な環境変数の一覧と説明
  - [ ] `.env.example` ファイルの作成
  - [ ] 各環境（開発/ステージング/本番）での設定方法
  
- [ ] APIドキュメントの自動生成
  - [ ] OpenAPI/Swagger仕様書の作成
  - [ ] APIエンドポイントの一覧と使用方法
  
- [ ] デプロイメントガイド
  - [ ] Vercelへのデプロイ手順
  - [ ] データベースのセットアップ
  - [ ] 環境変数の設定

### テスト
- [ ] E2Eテストの追加
  - [ ] Cypress/Playwrightの導入
  - [ ] 主要なユーザーフローのテスト
  
- [ ] 統合テストの拡充
  - [ ] APIエンドポイントの統合テスト
  - [ ] データベーストランザクションのテスト
  
- [ ] パフォーマンステスト
  - [ ] 負荷テストツールの導入
  - [ ] APIレスポンスタイムの測定

### 開発環境
- [ ] Docker環境の整備
  - [ ] `docker-compose.yml` の作成
  - [ ] 開発環境の統一化
  
- [ ] CI/CDパイプラインの改善
  - [ ] 自動テストの実行
  - [ ] コードカバレッジのレポート
  - [ ] 自動デプロイの設定

### コード品質
- [ ] TypeScriptの型定義の改善
  - [ ] `any` 型の削減
  - [ ] 共通の型定義ファイルの整理
  
- [ ] コンポーネントの再利用性向上
  - [ ] 共通コンポーネントの抽出
  - [ ] Storybookの導入検討
  
- [ ] コードの重複削減
  - [ ] 共通処理のユーティリティ化
  - [ ] カスタムフックの作成

## 🐛 既知のバグ

### 機能的なバグ
- [ ] 検索ページでの質問検索が動作しない（APIエンドポイント未実装）
- [ ] パスワードリセット機能が完全に動作しない（トークン管理未実装）
- [ ] ファイルアップロード後の表示/ダウンロードが不完全

### UI/UXのバグ
- [ ] モバイル表示での一部レイアウト崩れ
- [ ] ダークモード時の一部コンポーネントの視認性問題
- [ ] 長いテキストでのオーバーフロー処理不足

### セキュリティのバグ
- [ ] セッション管理の脆弱性（JWT有効期限の適切な設定）
- [ ] ファイルアップロードのバリデーション不足
- [ ] SQLインジェクション対策の不足（Prismaを使用しているため低リスクだが確認必要）

## 🔍 調査が必要な項目

- [ ] リアルタイム通知機能の実装方法（WebSocket/Server-Sent Events）
- [ ] 大規模ファイルアップロードの最適化（チャンクアップロード）
- [ ] 国際化（i18n）対応の必要性
- [ ] アクセシビリティ（WCAG 2.2）準拠の詳細確認
- [ ] パフォーマンス監視ツールの導入（Sentry、DataDog等）

## 📅 実装優先順位

1. **緊急対応が必要**
   - `/api/questions` エンドポイントの実装
   - PasswordResetTokenモデルの追加
   - 基本的なセキュリティ対策

2. **早期に対応すべき**
   - メール送信機能の実装
   - ログ機能の実装
   - エラーハンドリングの改善

3. **計画的に対応**
   - フォームビルダーUIの実装
   - ドキュメントの整備
   - テストの拡充

4. **長期的な改善**
   - パフォーマンス最適化
   - コード品質の向上
   - 開発環境の改善
