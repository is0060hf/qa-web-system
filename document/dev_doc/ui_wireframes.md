# 質問管理Webシステム UIワイヤーフレーム設計

## 1. はじめに

本ドキュメントは、質問管理Webシステムのユーザーインターフェース（UI）の構造と主要コンポーネントを定義するワイヤーフレーム設計です。Material UI v5をベースとし、レスポンシブデザインを考慮します。

## 2. 全体レイアウト

*   **ヘッダー:**
    *   左側: システムロゴ（または名称）
    *   中央: (状況に応じて) ページタイトルやパンくずリスト
    *   右側: 通知ベルアイコン (未読件数バッジ付き)、ユーザーアバター (クリックでメニュー表示: プロフィール設定、ログアウト)
*   **サイドナビゲーション (左側、折りたたみ可能):**
    *   ダッシュボード (プロジェクト一覧)
    *   担当中の質問一覧
    *   新規質問作成 (フローティングアクションボタン(FAB)も検討)
    *   (Admin/プロジェクト管理者向け) ユーザー管理
    *   (Admin/プロジェクト管理者向け) プロジェクト設定
    *   通知一覧
*   **メインコンテンツエリア:** 各ページの主要コンテンツが表示されます。
*   **フッター:** (任意) コピーライト情報など。

## 3. 主要画面設計

### 3.1. ログイン/登録画面

**認証要件: これらの画面は認証不要（パブリックアクセス可能）です。**

*   **ログイン画面:**
    *   中央配置のカードコンポーネント
    *   システムロゴ/名称
    *   メールアドレス入力フィールド (Material UI TextField)
    *   パスワード入力フィールド (Material UI TextField, パスワード可視化トグル付き)
    *   「ログイン」ボタン (Material UI Button, Primary)
    *   「パスワードをお忘れですか？」リンク
    *   「アカウントをお持ちでない場合: 新規登録」リンク
*   **新規登録画面:**
    *   ログイン画面と類似のレイアウト
    *   氏名入力フィールド (任意)
    *   メールアドレス入力フィールド
    *   パスワード入力フィールド
    *   パスワード確認入力フィールド
    *   「登録」ボタン
    *   「アカウントをお持ちの場合: ログイン」リンク
*   **パスワードリセット要求画面:**
    *   メールアドレス入力フィールド
    *   「リセットリンクを送信」ボタン
*   **パスワードリセット実行画面:**
    *   新しいパスワード入力フィールド
    *   新しいパスワード確認入力フィールド
    *   「パスワードを更新」ボタン

### 3.2. ダッシュボード / プロジェクト一覧画面

*   **タイトル:** ダッシュボード / プロジェクト一覧
*   **上部:**
    *   「新規プロジェクト作成」ボタン (管理者/Adminのみ表示)
    *   検索バー (プロジェクト名で検索)
*   **メインエリア:**
    *   プロジェクトカードのグリッド表示、またはテーブル表示 (Material UI DataGrid)
        *   **カード表示の場合:** プロジェクト名、説明(一部)、メンバー数、最終更新日時、設定ボタン(管理者/Admin)
        *   **テーブル表示の場合:** 列: プロジェクト名, 説明, 作成者, メンバー数, 最終更新日時, アクション(詳細表示、設定)
    *   ページネーション

### 3.3. プロジェクト詳細画面

*   **ヘッダー:** プロジェクト名
*   **タブ:**
    *   **質問一覧:** (デフォルト表示)
        *   上部: 「新規質問作成」ボタン、検索フィルター (キーワード, 担当者, ステータス, 優先度, タグ, 期限切れ)
        *   メイン: 質問テーブル (Material UI DataGrid)
            *   列: タイトル, ステータス, 担当者, 質問者, 優先度, 期限, タグ, 作成日時, アクション(詳細表示)
            *   ソート、フィルタリング機能
            *   ページネーション
    *   **メンバー:**
        *   上部: 「メンバーを招待」ボタン (管理者/Admin)
        *   メイン: メンバーテーブル (Material UI DataGrid)
            *   列: ユーザー名, メールアドレス, 役割(Manager/Member), 参加日時, アクション(役割変更、除外 - 管理者/Admin)
    *   **設定:** (管理者/Adminのみ表示)
        *   プロジェクト名編集フィールド
        *   プロジェクト説明編集テキストエリア
        *   タグ管理セクション:
            *   現在のタグ一覧 (編集、削除ボタン付き)
            *   新規タグ追加フォーム (タグ名入力、追加ボタン)
        *   保留中の招待一覧
        *   プロジェクト削除ボタン (Adminのみ？要確認)

### 3.4. 質問詳細画面

*   **ヘッダー:** 質問タイトル (ステータス、優先度、タグをバッジ表示)
*   **上部:**
    *   質問者、担当者、作成日時、最終更新日時、回答期限表示
    *   「編集」ボタン (質問者/管理者/Admin)
    *   「削除」ボタン (質問者/管理者/Admin)
    *   「クローズ」ボタン (質問者、ステータスが承認待ちの場合)
    *   「再開」ボタン (質問者、ステータスがクローズの場合)
*   **メインエリア (2カラムレイアウトも検討):**
    *   **左側 (または上部): 質問内容**
        *   質問本文表示エリア (Markdown対応)
    *   **右側 (または下部): 回答スレッド**
        *   時系列に回答を表示するカードリスト
            *   各カード: 回答者アバター/名前, 回答日時, 回答内容(Markdown対応), 添付ファイル(画像プレビュー、動画/ファイルリンク), 編集/削除ボタン(回答者本人)
        *   **回答入力エリア (担当者/管理者/Admin向け):**
            *   **自由記述の場合:** リッチテキストエディタ (Markdownサポート)
            *   **回答フォームの場合:** 定義されたフォームフィールドを表示 (Material UI TextField, RadioGroup, Textarea, FileUpload)
            *   ファイル添付ボタン (Vercel Blob連携)
            *   「回答を投稿」ボタン
        *   **会話から新規質問作成:** 各回答に「この回答から質問を作成」ボタン (クリックで新規質問作成画面へ遷移、内容引用)

### 3.5. 質問作成/編集画面

*   **タイトル:** 新規質問作成 / 質問編集
*   **フォーム:**
    *   プロジェクト選択 (作成時、ドロップダウン)
    *   質問タイトル入力 (TextField)
    *   質問内容入力 (リッチテキストエディタ/Textarea)
    *   担当者選択 (ユーザー選択コンポーネント、オートコンプリート)
    *   回答期限設定 (DatePicker)
    *   優先度選択 (Select/RadioGroup: 最高, 高, 中, 低)
    *   タグ選択 (MultiSelect/ChipInput, プロジェクト固有タグを表示)
    *   **回答形式選択:**
        *   ラジオボタン: 「自由記述」「回答フォームを使用」
        *   **回答フォーム選択/作成エリア (「回答フォームを使用」選択時):**
            *   「テンプレートから選択」ドロップダウン
            *   「新規フォームを作成」ボタン -> フォームビルダーUI表示
                *   フィールド追加ボタン (+)
                *   フィールドリスト (各フィールド: ラベル入力, タイプ選択(TEXT, NUMBER, RADIO, FILE, TEXTAREA), オプション入力(RADIO), 必須チェックボックス, 並び替えハンドル, 削除ボタン)
                *   「このフォームをテンプレートとして保存」チェックボックス＋テンプレート名入力
*   **下部:**
    *   「作成」/「更新」ボタン
    *   「キャンセル」ボタン

### 3.6. 担当中の質問一覧画面

*   **タイトル:** 担当中の質問
*   **上部:** 検索フィルター (キーワード, プロジェクト, ステータス, 優先度, 期限切れ)
*   **メインエリア:** 質問テーブル (Material UI DataGrid)
    *   列: タイトル, プロジェクト名, ステータス, 質問者, 優先度, 期限, 作成日時, アクション(詳細表示)
    *   デフォルトで未完了(NEW, IN_PROGRESS, PENDING_APPROVAL)の質問を表示
    *   期限が近い/切れているものを強調表示
    *   ページネーション

### 3.7. 通知ドロップダウン/一覧画面

*   **ドロップダウン (ヘッダーのベルアイコンクリック):**
    *   最新5件の未読通知リスト
    *   各通知: アイコン(タイプ別), メッセージ(一部), 日時, クリックで関連ページへ遷移＆既読化
    *   下部に「すべて既読にする」ボタン
    *   下部に「通知一覧へ」リンク
*   **通知一覧画面:**
    *   タイトル: 通知一覧
    *   上部: 「未読のみ表示」スイッチ/チェックボックス, 「すべて既読にする」ボタン
    *   メインエリア: 通知リスト (スクロール読み込み or ページネーション)
        *   各通知: アイコン, メッセージ(全文), 日時, 関連情報(プロジェクト名/質問タイトルなど), クリックで関連ページへ遷移＆既読化

### 3.8. ユーザープロフィール/設定画面

*   **タイトル:** プロフィール設定
*   **フォーム:**
    *   氏名編集フィールド
    *   メールアドレス表示 (変更不可)
    *   パスワード変更セクション:
        *   現在のパスワード入力
        *   新しいパスワード入力
        *   新しいパスワード確認入力
        *   「パスワードを変更」ボタン
*   **下部:**
    *   「更新」ボタン

### 3.9. Admin ユーザー管理画面

*   **タイトル:** ユーザー管理
*   **上部:** 検索バー (メールアドレス/名前)
*   **メインエリア:** ユーザーテーブル (Material UI DataGrid)
    *   列: 氏名, メールアドレス, 役割(ADMIN/USER), 作成日時, アクション(編集[役割変更], 削除)
    *   ページネーション

## 4. レスポンシブデザイン

本システムはMaterial UI v5を活用し、以下のブレークポイントに基づいたレスポンシブデザインを実装します：

*   **xs:** 0px以上（スマートフォン - 縦向き）
*   **sm:** 600px以上（スマートフォン - 横向き / 小型タブレット）
*   **md:** 900px以上（タブレット）
*   **lg:** 1200px以上（デスクトップ）
*   **xl:** 1536px以上（大型デスクトップ）

### 4.1. 画面別レスポンシブ対応方針

*   **全体レイアウト:**
    *   **モバイル（xs / sm）:** 
        *   サイドナビゲーションはデフォルトで非表示、ハンバーガーメニューアイコンで表示切替
        *   表示時はドロワーとして画面の大部分を覆う形式
        *   ヘッダーは固定表示、タイトルとアクション（通知、プロフィール）のみをコンパクトに配置
    *   **タブレット（md）:** 
        *   サイドナビゲーションは小幅で常時表示、またはアイコンのみ表示でホバーで拡大
        *   メインコンテンツがより広いスペースを占有
    *   **デスクトップ（lg / xl）:** 
        *   サイドナビゲーションは常時表示、テキストラベル付き
        *   3カラムレイアウトも可能な場合は活用（例: 質問詳細画面）

*   **データグリッド/テーブル表示:**
    *   **モバイル（xs / sm）:** 
        *   テーブル表示をカード表示に切り替え、各行の情報を縦に積み重ねて表示
        *   多くの列を持つテーブルは、重要な2-3列のみを表示し、その他は折りたたみ表示
        *   タップで詳細表示するアクションを優先
    *   **タブレット（md）:** 
        *   テーブル表示を維持するが、二次的な情報列を非表示
        *   操作スペースを考慮して列幅を調整
    *   **デスクトップ（lg / xl）:** 
        *   全ての列を表示、データ密度の高い表示

*   **フォーム要素:**
    *   **モバイル（xs / sm）:** 
        *   フォーム要素を縦に1列で配置
        *   タッチ操作がしやすいよう余白を拡大
        *   複雑なフォーム（質問作成など）はステップ分割を検討
    *   **タブレット以上（md / lg / xl）:** 
        *   関連フォーム要素を横に並べてグループ化
        *   スペースを有効活用した2カラム以上のレイアウト

*   **質問詳細画面:**
    *   **モバイル（xs / sm）:** 
        *   質問内容と回答スレッドを縦に配置
        *   タブで切り替え表示も選択肢として検討
    *   **タブレット（md）:** 
        *   質問内容と回答スレッドを縦に配置、または約30:70の比率で横に配置
    *   **デスクトップ（lg / xl）:** 
        *   質問内容と回答スレッドを横に配置（約30:70の比率）

### 4.2. 実装テクニック

*   **Grid System:** Material UIの`Grid`コンポーネントを活用し、ブレークポイントに応じたレイアウト変更を実装します。
    ```jsx
    <Grid container spacing={2}>
      <Grid item xs={12} md={6} lg={4}>
        {/* xs=12（モバイルで全幅）、md=6（タブレットで半分）、lg=4（デスクトップで1/3幅） */}
        <Component />
      </Grid>
    </Grid>
    ```

*   **Flex Box:** 要素の配置に`Box`コンポーネントとflexboxを活用します。
    ```jsx
    <Box sx={{ 
      display: 'flex', 
      flexDirection: { xs: 'column', md: 'row' },
      justifyContent: 'space-between'
    }}>
      {/* モバイルでは縦並び、タブレット以上では横並び */}
    </Box>
    ```

*   **Responsive Hiding:** `sx`プロパティや`Hidden`コンポーネントを使用して、特定のブレークポイントで要素を表示/非表示にします。
    ```jsx
    <Box sx={{ display: { xs: 'none', md: 'block' } }}>
      {/* モバイルでは非表示、タブレット以上で表示 */}
    </Box>
    ```

*   **Stack:** 垂直または水平に要素を積み重ねる`Stack`コンポーネントを活用します。
    ```jsx
    <Stack 
      direction={{ xs: 'column', sm: 'row' }} 
      spacing={{ xs: 1, sm: 2, md: 4 }}
    >
      {/* 要素の方向と間隔がブレークポイントに応じて変化 */}
    </Stack>
    ```

## 5. アクセシビリティ対応

本システムはWCAG 2.1 AA準拠を目指し、以下のアクセシビリティ対応を実装します：

### 5.1. 基本対応方針

*   **キーボードアクセシビリティ:**
    *   全ての機能がキーボードのみで操作できるようにします。
    *   フォーカス順序を論理的に設定し、視覚的にわかりやすいフォーカスインジケータを表示します。
    *   キーボードトラップ（キーボードフォーカスが要素内に閉じ込められる状態）を防止します。
    *   ショートカットキーを主要機能に割り当てます（例: ESCキーでモーダルを閉じる）。

*   **スクリーンリーダー対応:**
    *   適切なARIA属性と意味のあるHTMLセマンティクスを使用します。
    *   画像に代替テキストを提供します。
    *   フォーム要素にはラベルを関連付けます。
    *   動的に変化するコンテンツには適切な通知を提供します。

*   **色とコントラスト:**
    *   テキストと背景のコントラスト比が4.5:1（小さいテキスト）または3:1（大きいテキスト）以上になるようにします。
    *   色のみに依存せず、アイコンやテキストラベルなど複数の識別手段を提供します。
    *   フォーカス状態を色だけでなく、アウトラインやアンダーラインなど視覚的な変化でも示します。

*   **拡大表示対応:**
    *   ブラウザの拡大機能（最大200%）使用時にも内容やレイアウトが崩れないようにします。
    *   フォントサイズを相対単位（rem/em）で設定し、ユーザーの設定を尊重します。

### 5.2. 実装テクニック

*   **適切なセマンティックHTML:** ヘッダー、ナビゲーション、メインコンテンツ、フッターに適切なHTML5要素を使用します。
    ```jsx
    <header>...</header>
    <nav>...</nav>
    <main>...</main>
    <footer>...</footer>
    ```

*   **ARIA属性の活用:** 必要に応じてARIA属性を追加して、スクリーンリーダーに適切な情報を提供します。
    ```jsx
    <Button
      aria-label="通知一覧を開く"
      aria-expanded={isOpen}
      aria-haspopup="true"
      onClick={handleClick}
    >
      <NotificationsIcon />
      <Badge badgeContent={count} color="error" aria-label={`${count}件の未読通知があります`} />
    </Button>
    ```

*   **フォーム要素のラベル:** 全てのフォーム要素にラベルを関連付けます。
    ```jsx
    <TextField 
      id="email"
      label="メールアドレス"
      required
      inputProps={{ 'aria-required': 'true' }}
      error={!!errors.email}
      helperText={errors.email || ''}
    />
    ```

*   **DataGrid/テーブルのアクセシビリティ:** Material UI DataGridの組み込みアクセシビリティ機能を活用します。
    ```jsx
    <DataGrid
      aria-label="プロジェクト一覧"
      rows={projects}
      columns={columns}
      pagination
      pageSize={pageSize}
      onPageSizeChange={handlePageSizeChange}
      getRowId={(row) => row.id}
    />
    ```

*   **エラー通知:** フォーム送信エラーなどは視覚的だけでなく、スクリーンリーダーにも伝わるようにします。
    ```jsx
    <Alert 
      severity="error"
      aria-live="assertive"
      role="alert"
    >
      {errorMessage}
    </Alert>
    ```

*   **モーダルダイアログのアクセシビリティ:** フォーカス管理やキーボード操作に配慮します。
    ```jsx
    <Dialog
      open={open}
      onClose={handleClose}
      aria-labelledby="dialog-title"
      aria-describedby="dialog-description"
    >
      <DialogTitle id="dialog-title">確認</DialogTitle>
      <DialogContent>
        <DialogContentText id="dialog-description">
          本当に削除しますか？
        </DialogContentText>
      </DialogContent>
      <DialogActions>
        <Button onClick={handleClose}>キャンセル</Button>
        <Button onClick={handleConfirm} autoFocus>削除する</Button>
      </DialogActions>
    </Dialog>
    ```

## 6. 多言語対応

本システムでは多言語対応は実装せず、日本語のみのサポートとします。将来的に多言語対応が必要になった場合に備え、テキストのハードコーディングは避け、集中管理できる構造にしておくことを推奨します。

## 7. その他の考慮事項

*   **状態管理(Zustand)とAPIキャッシュ(React Query)を活用**し、UIの状態とサーバーデータの同期を効率的に行います。
*   **ローディング状態やエラーステート**を適切に表示します（スピナー、スケルトンローダー、エラーメッセージ）。
*   **ダークモード**は初期実装では含めませんが、Material UIのテーマシステムを利用することで、将来的な追加が容易になる構造を検討します。

